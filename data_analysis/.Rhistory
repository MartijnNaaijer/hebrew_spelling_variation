table(dat$book2)
# Make 2 scrolls of 1Qisaa
dat$scroll <- ifelse(dat$scroll == '1Qisaa' & dat$chapter < 34, '1QisaaI',
ifelse(dat$scroll == '1Qisaa' & dat$chapter > 33, '1QisaaII',
dat$scroll))
dat$scroll <- as.factor(dat$scroll)
dat$scr_book2 <- paste(dat$scroll, dat$book2, sep='_')
mt_sp_books <- unique(dat$scr_book2)
mt_sp_books
dat$scr_book2 <- factor(dat$scr_book2, levels = mt_sp_books)
unique(dat$scr_book2)
dat$book2 <- as.factor(dat$book2)
dat$phase <- ifelse(dat$book %in% EBH_BOOKS, 'EBH', ifelse(dat$book %in% LBH_BOOKS, 'LBH', 'NO'))
dat$law_phase <- ifelse(dat$book %in% LAW_BOOKS, 0, ifelse(dat$book %in% EBH_BOOKS, 1,
ifelse(dat$book %in% LBH_BOOKS, 2, 3)))
dat$law_phase <- as.factor(dat$law_phase)
dat$qsp_sp <- ifelse(dat$scroll %in% QSP_SCROLLS, 'QSP', ifelse(dat$scroll == 'SP', 'SP', 'Other'))
dat$qsp_sp <- as.factor(dat$qsp_sp)
table(dat$qsp_sp)
str(dat)
dat$type
dat$type <- factor(dat$type, levels = c('last', 'first', 'single'))
levels(dat$type)
# Merge single and last syllables in new variable type2
dat$type2 <- ifelse(dat$type %in% c('single', 'last'), 'last', 'first')
dat$type2 <- factor(dat$type2, levels = c('last', 'first'))
dat$lex_type <- paste(dat$lex, dat$type2, sep='_')
dat$lex_type <- as.factor(dat$lex_type)
dat$law_phase2 <- ifelse(dat$book %in% LAW_BOOKS, 'Pent',
ifelse(dat$book %in% EBH_BOOKS, 'FP',
ifelse(dat$book %in% LBH_BOOKS, 'LBH',
'Other')))
dat$law_phase2 <- ifelse(!dat$scroll %in% c(c('MT', 'SP'), QSP_SCROLLS), paste0(dat$law_phase2, '_non_QSP'),
ifelse(dat$scroll %in% QSP_SCROLLS, paste0(dat$law_phase2, '_QSP'),
ifelse(dat$scroll == 'SP', paste0(dat$law_phase2, '_SP'),
dat$law_phase2)))
dat$law_phase2 <- as.factor(dat$law_phase2)
law_phase2_levels <- c('Pent', 'Pent_SP', 'FP', 'LBH', 'Other',
'Pent_non_QSP', 'FP_non_QSP', 'LBH_non_QSP',
'Other_non_QSP',
'Pent_QSP', 'FP_QSP', 'Other_QSP')
dat$law_phase2 <- factor(dat$law_phase2, levels=law_phase2_levels)
levels(dat$law_phase2)
dat[is.na(dat$law_phase2),]
dim(dat)
head(dat)
str(dat)
fit_brm_model <- function(data, formula, warmup, iter, adapt_delta) {
trace <- brm(formula = formula,
prior = set_prior("normal(0, 5)", class = "Intercept") +
set_prior("normal(0, 5)", class = "b"),
data = data,
family = bernoulli(link = "logit"),
warmup = warmup,
iter = iter,
chains = 4,
cores = 4,
control = list(adapt_delta = adapt_delta),
seed = 123)
return(trace)
}
###############################################################################
str(dat)
table(dat$qsp, dat$has_vowel_letter)
sp_df <- dat |> filter(scroll == 'SP')
table(sp_df$has_suffix, sp_df$has_vowel_letter)
tapply(as.numeric(as.character(dat$has_vowel_letter)), dat$scroll, mean)
table(dat$scroll)
mt_df <- dat |> filter(scroll == 'MT')
tapply(as.numeric(as.character(mt_df$has_vowel_letter)), mt_df$book, mean)
table(dat$has_prefix)
table(dat$has_suffix)
table(dat$has_prefix, dat$has_vowel_letter)
formula_mt_dss_infa <- has_vowel_letter ~
has_prefix*law_phase2 +
(has_prefix | scr_book2) +
(has_prefix | lex_type)
bayes_model_mt_dss_infa <- fit_brm_model(dat,
formula_mt_dss_infa,
2000, 4000, 0.97)
summary(bayes_model_mt_dss_infa)
ranef(bayes_model_mt_dss_infa)
bayes_R2(bayes_model_mt_infa)
bayes_R2(bayes_model_mt_dss_infa)
file_path_mt_dss_infa <- file.path(MODEL_FOLDER, 'bayes_model_mt_dss_affix_effect_infa.rds')
saveRDS(bayes_model_mt_dss_infa, file = file_path_mt_dss_infa)
trace_mt <- readRDS(file_path_mt_dss_infa)
model_vars <- get_variables(trace_mt)
model_vars
random_intercept <- ranef(trace_mt)$lex_type[,,'Intercept'] |> as.data.frame()
random_intercept <- random_intercept[order(random_intercept$Estimate),]
random_intercept$lex_type <- factor(rownames(random_intercept), levels=rownames(random_intercept))
head(random_intercept, 30)
tail(random_intercept, 40)
random_intercept %>%
ggplot(aes(y = lex_type, x = Estimate, xmin = Q2.5, xmax = Q97.5)) +
geom_pointinterval() +
ggtitle('Random Intercept')
model_vars
summary_prefix_mt <- fixed_draws %>%
transmute('Intercept Pentateuch' = b_Intercept,
'With Prefix' = b_Intercept + b_has_prefix1,
'Intercept Former Prophets' = b_Intercept + b_law_phase2FP,
'With Prefix Former Prophets' = b_Intercept + b_law_phase2FP + b_has_prefix1 + `b_has_prefix1:law_phase2FP`,
'Intercept LBH' = b_Intercept + b_law_phase2LBH,
'With Prefix LBH' = b_Intercept + b_law_phase2LBH + b_has_prefix1 + `b_has_prefix1:law_phase2LBH`,
'Intercept Other' = b_Intercept + b_qspQSP,
'With Prefix Other' = b_Intercept + b_qspQSP + b_has_prefix1 + `b_qspQSP:has_prefix1`,
) %>%
gather() %>%
group_by(key) %>%
mean_hdi(.width = c(.95, .66))
fixed_draws <- trace_mt %>%
spread_draws(b_Intercept,
b_has_prefix1,
`b_law_phase2FP`, `b_law_phase2LBH`,
`b_law_phase2Other`, `b_law_phase2Pent_non_QSP`,
`b_law_phase2FP_non_QSP`,  `b_law_phase2Other_non_QSP`,
`b_law_phase2Pent_QSP`, `b_law_phase2FP_QSP`,
`b_law_phase2Other_QSP`,  `b_has_prefix1:law_phase2FP`,
`b_has_prefix1:law_phase2LBH`,  `b_has_prefix1:law_phase2Other`,
`b_has_prefix1:law_phase2Pent_non_QSP`, `b_has_prefix1:law_phase2FP_non_QSP`,
`b_has_prefix1:law_phase2Other_non_QSP`,  `b_has_prefix1:law_phase2Pent_QSP`,
`b_has_prefix1:law_phase2FP_QSP`, `b_has_prefix1:law_phase2Other_QSP`
)
head(fixed_draws)
summary_prefix_mt <- fixed_draws %>%
transmute('Intercept Pentateuch' = b_Intercept,
'With Prefix' = b_Intercept + b_has_prefix1,
'Intercept Former Prophets' = b_Intercept + b_law_phase2FP,
'With Prefix Former Prophets' = b_Intercept + b_law_phase2FP + b_has_prefix1 + `b_has_prefix1:law_phase2FP`,
'Intercept LBH' = b_Intercept + b_law_phase2LBH,
'With Prefix LBH' = b_Intercept + b_law_phase2LBH + b_has_prefix1 + `b_has_prefix1:law_phase2LBH`,
'Intercept Other' = b_Intercept + b_qspQSP,
'With Prefix Other' = b_Intercept + b_qspQSP + b_has_prefix1 + `b_qspQSP:has_prefix1`,
) %>%
gather() %>%
group_by(key) %>%
mean_hdi(.width = c(.95, .66))
summary_prefix_mt <- fixed_draws %>%
transmute('Intercept Pentateuch' = b_Intercept,
'With Prefix' = b_Intercept + b_has_prefix1,
'Intercept Former Prophets' = b_Intercept + b_law_phase2FP,
'With Prefix Former Prophets' = b_Intercept + b_law_phase2FP + b_has_prefix1 + `b_has_prefix1:law_phase2FP`,
'Intercept LBH' = b_Intercept + b_law_phase2LBH,
'With Prefix LBH' = b_Intercept + b_law_phase2LBH + b_has_prefix1 + `b_has_prefix1:law_phase2LBH`,
'Intercept Other' = b_Intercept + b_law_phase2Other,
'With Prefix Other' = b_Intercept + b_law_phase2Other + b_has_prefix1 + b_has_prefix1:law_phase2Other,
) %>%
gather() %>%
group_by(key) %>%
mean_hdi(.width = c(.95, .66))
summary_prefix_mt <- fixed_draws %>%
transmute('Intercept Pentateuch' = b_Intercept,
'With Prefix' = b_Intercept + b_has_prefix1,
'Intercept Former Prophets' = b_Intercept + b_law_phase2FP,
'With Prefix Former Prophets' = b_Intercept + b_law_phase2FP + b_has_prefix1 + `b_has_prefix1:law_phase2FP`,
'Intercept LBH' = b_Intercept + b_law_phase2LBH,
'With Prefix LBH' = b_Intercept + b_law_phase2LBH + b_has_prefix1 + `b_has_prefix1:law_phase2LBH`,
'Intercept Other' = b_Intercept + b_law_phase2Other,
'With Prefix Other' = b_Intercept + b_law_phase2Other + b_has_prefix1 + b_has_prefix1:law_phase2Other,
) %>%
gather() %>%
group_by(key) %>%
mean_hdi(.width = c(.95, .66))
summary_prefix_mt <- fixed_draws %>%
transmute('Intercept Pentateuch' = b_Intercept,
'With Prefix' = b_Intercept + b_has_prefix1,
'Intercept Former Prophets' = b_Intercept + b_law_phase2FP,
'With Prefix Former Prophets' = b_Intercept + b_law_phase2FP + b_has_prefix1 + `b_has_prefix1:law_phase2FP`,
'Intercept LBH' = b_Intercept + b_law_phase2LBH,
'With Prefix LBH' = b_Intercept + b_law_phase2LBH + b_has_prefix1 + `b_has_prefix1:law_phase2LBH`,
'Intercept Other' = b_Intercept + b_law_phase2Other,
'With Prefix Other' = b_Intercept + b_law_phase2Other + b_has_prefix1 + `b_has_prefix1:law_phase2Other`,
) %>%
gather() %>%
group_by(key) %>%
mean_hdi(.width = c(.95, .66))
labels_prefix <- c(
'With Prefix Other',
'Intercept Other',
'With Prefix LBH',
'Intercept LBH',
'With Prefix Former Prophets',
'Intercept Former Prophets',
'With Prefix Pentateuch',
'Intercept Pentateuch'
)
summary_prefix_mt$key <- factor(summary_first_prefix_mt$key, levels = labels_prefix)
summary_prefix_mt$key <- factor(summary_prefix_mt$key, levels = labels_prefix)
summary_prefix_mt %>%
ggplot(aes(y = key, x = value, xmin = .lower, xmax = .upper)) +
geom_pointinterval() +
ggtitle('Logodds of a vowel letter in an active participle with or without a suffix in Other, SP and QSP')
summary_prefix_mt <- fixed_draws %>%
transmute('Intercept Pentateuch' = b_Intercept,
'With Prefix Pentateuch' = b_Intercept + b_has_prefix1,
'Intercept Former Prophets' = b_Intercept + b_law_phase2FP,
'With Prefix Former Prophets' = b_Intercept + b_law_phase2FP + b_has_prefix1 + `b_has_prefix1:law_phase2FP`,
'Intercept LBH' = b_Intercept + b_law_phase2LBH,
'With Prefix LBH' = b_Intercept + b_law_phase2LBH + b_has_prefix1 + `b_has_prefix1:law_phase2LBH`,
'Intercept Other' = b_Intercept + b_law_phase2Other,
'With Prefix Other' = b_Intercept + b_law_phase2Other + b_has_prefix1 + `b_has_prefix1:law_phase2Other`,
) %>%
gather() %>%
group_by(key) %>%
mean_hdi(.width = c(.95, .66))
labels_prefix <- c(
'With Prefix Other',
'Intercept Other',
'With Prefix LBH',
'Intercept LBH',
'With Prefix Former Prophets',
'Intercept Former Prophets',
'With Prefix Pentateuch',
'Intercept Pentateuch'
)
summary_prefix_mt$key <- factor(summary_prefix_mt$key, levels = labels_prefix)
summary_prefix_mt %>%
ggplot(aes(y = key, x = value, xmin = .lower, xmax = .upper)) +
geom_pointinterval() +
ggtitle('Logodds of a vowel letter in an active participle with or without a suffix in Other, SP and QSP')
summary_prefix_mt$prob_value <- logit2prob(summary_prefix_mt$value)
summary_prefix_mt$prob_lower <- logit2prob(summary_prefix_mt$.lower)
summary_prefix_mt$prob_upper <- logit2prob(summary_prefix_mt$.upper)
summary_prefix_mt[0:20,]
summary_prefix_mt %>%
ggplot(aes(y = key, x = value, xmin = prob_lower, xmax = prob_upper)) +
geom_pointinterval() +
ggtitle('')
summary_prefix_mt %>%
ggplot(aes(y = key, x = prob_value, xmin = prob_lower, xmax = prob_upper)) +
geom_pointinterval() +
ggtitle('')
summary_prefix_dss <- fixed_draws %>%
transmute('Intercept Pentateuch non-QSP' = b_Intercept + b_law_phase2Pent_non_QSP,
'With Prefix Pentateuch non-QSP' = b_Intercept + b_law_phase2Pent_non_QSP + b_has_prefix1 + `b_has_prefix1:law_phase2Pent_non_QSP`,
'Intercept Former Prophets non_QSP' = b_Intercept + b_law_phase2FP_non_QSP,
'With Prefix Former Prophets non-QSP' = b_Intercept + b_law_phase2FP_non_QSP + b_has_prefix1 + `b_has_prefix1:law_phase2FP_non_QSP`,
'Intercept Other non-QSP' = b_Intercept + b_law_phase2Other_non_QSP,
'With Prefix Other non-QSP' = b_Intercept + b_law_phase2Other_non_QSP + b_has_prefix1 + `b_has_prefix1:law_phase2Other_non_QSP`,
) %>%
gather() %>%
group_by(key) %>%
mean_hdi(.width = c(.95, .66))
summary_prefix_dss <- fixed_draws %>%
transmute('Intercept Pentateuch non-QSP' = b_Intercept + b_law_phase2Pent_non_QSP,
'With Prefix Pentateuch non-QSP' = b_Intercept + b_law_phase2Pent_non_QSP + b_has_prefix1 + `b_has_prefix1:law_phase2Pent_non_QSP`,
'Intercept Former Prophets non_QSP' = b_Intercept + b_law_phase2FP_non_QSP,
'With Prefix Former Prophets non-QSP' = b_Intercept + b_law_phase2FP_non_QSP + b_has_prefix1 + `b_has_prefix1:law_phase2FP_non_QSP`,
'Intercept Other non-QSP' = b_Intercept + b_law_phase2Other_non_QSP,
'With Prefix Other non-QSP' = b_Intercept + b_law_phase2Other_non_QSP + b_has_prefix1 + `b_has_prefix1:law_phase2Other_non_QSP`,
'Intercept Pentateuch QSP' = b_Intercept + b_law_phase2Pent_QSP,
'With Prefix Pentateuch QSP' = b_Intercept + b_law_phase2Pent_QSP + b_has_prefix1 + `b_has_prefix1:law_phase2Pent_QSP`,
'Intercept Former Prophets QSP' = b_Intercept + b_law_phase2FP_QSP,
'With Prefix Former Prophets QSP' = b_Intercept + b_law_phase2FP_QSP + b_has_prefix1 + `b_has_prefix1:law_phase2FP_QSP`,
'Intercept Other QSP' = b_Intercept + b_law_phase2Other_QSP,
'With Prefix Other QSP' = b_Intercept + b_law_phase2Other_QSP + b_has_prefix1 + `b_has_prefix1:law_phase2Other_QSP`,
) %>%
gather() %>%
group_by(key) %>%
mean_hdi(.width = c(.95, .66))
labels_prefix_dss <- c(
'With Prefix Other',
'Intercept Other',
'With Prefix Former Prophets QSP',
'Intercept Former Prophets QSP',
'With Prefix Pentateuch QSP',
'Intercept Pentateuch QSP',
'With Prefix Other non-QSP',
'Intercept Other non-QSP',
'With Prefix Former Prophets non-QSP',
'Intercept Former Prophets non-QSP',
'With Prefix Pentateuch non-QSP',
'Intercept Pentateuch non-QSP'
)
summary_prefix_dss$key <- factor(summary_prefix_dss$key, levels = labels_prefix_dss)
summary_prefix_dss$prob_value <- logit2prob(summary_prefix_dss$value)
summary_prefix_dss$prob_lower <- logit2prob(summary_prefix_dss$.lower)
summary_prefix_dss$prob_upper <- logit2prob(summary_prefix_dss$.upper)
summary_prefix_dss[0:20,]
summary_prefix_dss %>%
ggplot(aes(y = key, x = prob_value, xmin = prob_lower, xmax = prob_upper)) +
geom_pointinterval() +
ggtitle('')
summary_prefix_dss <- fixed_draws %>%
transmute('Intercept Pentateuch non-QSP' = b_Intercept + b_law_phase2Pent_non_QSP,
'With Prefix Pentateuch non-QSP' = b_Intercept + b_law_phase2Pent_non_QSP + b_has_prefix1 + `b_has_prefix1:law_phase2Pent_non_QSP`,
'Intercept Former Prophets non_QSP' = b_Intercept + b_law_phase2FP_non_QSP,
'With Prefix Former Prophets non-QSP' = b_Intercept + b_law_phase2FP_non_QSP + b_has_prefix1 + `b_has_prefix1:law_phase2FP_non_QSP`,
'Intercept Other non-QSP' = b_Intercept + b_law_phase2Other_non_QSP,
'With Prefix Other non-QSP' = b_Intercept + b_law_phase2Other_non_QSP + b_has_prefix1 + `b_has_prefix1:law_phase2Other_non_QSP`,
'Intercept Pentateuch QSP' = b_Intercept + b_law_phase2Pent_QSP,
'With Prefix Pentateuch QSP' = b_Intercept + b_law_phase2Pent_QSP + b_has_prefix1 + `b_has_prefix1:law_phase2Pent_QSP`,
'Intercept Former Prophets QSP' = b_Intercept + b_law_phase2FP_QSP,
'With Prefix Former Prophets QSP' = b_Intercept + b_law_phase2FP_QSP + b_has_prefix1 + `b_has_prefix1:law_phase2FP_QSP`,
'Intercept Other QSP' = b_Intercept + b_law_phase2Other_QSP,
'With Prefix Other QSP' = b_Intercept + b_law_phase2Other_QSP + b_has_prefix1 + `b_has_prefix1:law_phase2Other_QSP`,
) %>%
gather() %>%
group_by(key) %>%
mean_hdi(.width = c(.95, .66))
summary_prefix_dss
summary_prefix_dss <- fixed_draws %>%
transmute('Intercept Pentateuch non-QSP' = b_Intercept + b_law_phase2Pent_non_QSP,
'With Prefix Pentateuch non-QSP' = b_Intercept + b_law_phase2Pent_non_QSP + b_has_prefix1 + `b_has_prefix1:law_phase2Pent_non_QSP`,
'Intercept Former Prophets non_QSP' = b_Intercept + b_law_phase2FP_non_QSP,
'With Prefix Former Prophets non-QSP' = b_Intercept + b_law_phase2FP_non_QSP + b_has_prefix1 + `b_has_prefix1:law_phase2FP_non_QSP`,
'Intercept Other non-QSP' = b_Intercept + b_law_phase2Other_non_QSP,
'With Prefix Other non-QSP' = b_Intercept + b_law_phase2Other_non_QSP + b_has_prefix1 + `b_has_prefix1:law_phase2Other_non_QSP`,
'Intercept Pentateuch QSP' = b_Intercept + b_law_phase2Pent_QSP,
'With Prefix Pentateuch QSP' = b_Intercept + b_law_phase2Pent_QSP + b_has_prefix1 + `b_has_prefix1:law_phase2Pent_QSP`,
'Intercept Former Prophets QSP' = b_Intercept + b_law_phase2FP_QSP,
'With Prefix Former Prophets QSP' = b_Intercept + b_law_phase2FP_QSP + b_has_prefix1 + `b_has_prefix1:law_phase2FP_QSP`,
'Intercept Other QSP' = b_Intercept + b_law_phase2Other_QSP,
'With Prefix Other QSP' = b_Intercept + b_law_phase2Other_QSP + b_has_prefix1 + `b_has_prefix1:law_phase2Other_QSP`,
) %>%
gather() %>%
group_by(key) %>%
mean_hdi(.width = c(.95, .66))
summary_prefix_dss
labels_prefix_dss <- c(
'With Prefix Other',
'Intercept Other',
'With Prefix Former Prophets QSP',
'Intercept Former Prophets QSP',
'With Prefix Pentateuch QSP',
'Intercept Pentateuch QSP',
'With Prefix Other non-QSP',
'Intercept Other non-QSP',
'With Prefix Former Prophets non-QSP',
'Intercept Former Prophets non_QSP',
'With Prefix Pentateuch non-QSP',
'Intercept Pentateuch non-QSP'
)
summary_prefix_dss$key <- factor(summary_prefix_dss$key, levels = labels_prefix_dss)
summary_prefix_dss$prob_value <- logit2prob(summary_prefix_dss$value)
summary_prefix_dss$prob_lower <- logit2prob(summary_prefix_dss$.lower)
summary_prefix_dss$prob_upper <- logit2prob(summary_prefix_dss$.upper)
summary_prefix_dss[0:20,]
summary_prefix_dss %>%
ggplot(aes(y = key, x = prob_value, xmin = prob_lower, xmax = prob_upper)) +
geom_pointinterval() +
ggtitle('')
summary_prefix_dss <- fixed_draws %>%
transmute('Intercept Pentateuch non-QSP' = b_Intercept + b_law_phase2Pent_non_QSP,
'With Prefix Pentateuch non-QSP' = b_Intercept + b_law_phase2Pent_non_QSP + b_has_prefix1 + `b_has_prefix1:law_phase2Pent_non_QSP`,
'Intercept Former Prophets non_QSP' = b_Intercept + b_law_phase2FP_non_QSP,
'With Prefix Former Prophets non-QSP' = b_Intercept + b_law_phase2FP_non_QSP + b_has_prefix1 + `b_has_prefix1:law_phase2FP_non_QSP`,
'Intercept Other non-QSP' = b_Intercept + b_law_phase2Other_non_QSP,
'With Prefix Other non-QSP' = b_Intercept + b_law_phase2Other_non_QSP + b_has_prefix1 + `b_has_prefix1:law_phase2Other_non_QSP`,
'Intercept Pentateuch QSP' = b_Intercept + b_law_phase2Pent_QSP,
'With Prefix Pentateuch QSP' = b_Intercept + b_law_phase2Pent_QSP + b_has_prefix1 + `b_has_prefix1:law_phase2Pent_QSP`,
'Intercept Former Prophets QSP' = b_Intercept + b_law_phase2FP_QSP,
'With Prefix Former Prophets QSP' = b_Intercept + b_law_phase2FP_QSP + b_has_prefix1 + `b_has_prefix1:law_phase2FP_QSP`,
'Intercept Other QSP' = b_Intercept + b_law_phase2Other_QSP,
'With Prefix Other QSP' = b_Intercept + b_law_phase2Other_QSP + b_has_prefix1 + `b_has_prefix1:law_phase2Other_QSP`,
) %>%
gather() %>%
group_by(key) %>%
mean_hdi(.width = c(.95, .66))
summary_prefix_dss
labels_prefix_dss <- c(
'With Prefix Other QSP',
'Intercept Other QSP',
'With Prefix Former Prophets QSP',
'Intercept Former Prophets QSP',
'With Prefix Pentateuch QSP',
'Intercept Pentateuch QSP',
'With Prefix Other non-QSP',
'Intercept Other non-QSP',
'With Prefix Former Prophets non-QSP',
'Intercept Former Prophets non_QSP',
'With Prefix Pentateuch non-QSP',
'Intercept Pentateuch non-QSP'
)
summary_prefix_dss$key <- factor(summary_prefix_dss$key, levels = labels_prefix_dss)
summary_prefix_dss$prob_value <- logit2prob(summary_prefix_dss$value)
summary_prefix_dss$prob_lower <- logit2prob(summary_prefix_dss$.lower)
summary_prefix_dss$prob_upper <- logit2prob(summary_prefix_dss$.upper)
summary_prefix_dss[0:20,]
summary_prefix_dss %>%
ggplot(aes(y = key, x = prob_value, xmin = prob_lower, xmax = prob_upper)) +
geom_pointinterval() +
ggtitle('')
random_pref_slope <- ranef(trace_mt)$lex_type[,,'has_prefix1'] |> as.data.frame()
random_pref_slope <- random_pref_slope[order(random_pref_slope$Estimate),]
random_pref_slope$lex_type <- factor(rownames(random_pref_slope), levels=rownames(random_pref_slope))
head(random_pref_slope, 15)
tail(random_pref_slope, 15)
random_pref_slope %>%
ggplot(aes(y = lex_type, x = Estimate, xmin = Q2.5, xmax = Q97.5)) +
geom_pointinterval() +
ggtitle('Random prefix effect')
random_intercept <- ranef(trace_mt)$lex_type[,,'Intercept'] |> as.data.frame()
random_intercept <- random_intercept[order(random_intercept$Estimate),]
random_intercept$lex_type <- factor(rownames(random_intercept), levels=rownames(random_intercept))
head(random_intercept, 30)
tail(random_intercept, 40)
random_intercept %>%
ggplot(aes(y = lex_type, x = Estimate, xmin = Q2.5, xmax = Q97.5)) +
geom_pointinterval() +
ggtitle('Random Intercept')
model_vars <- get_variables(trace_mt)
model_vars
head(trace_mt)
summary(trace_mt)
fixed_draws <- trace_mt %>%
spread_draws(b_Intercept,
b_has_prefix1,
`b_law_phase2FP`, `b_law_phase2LBH`,
`b_law_phase2Other`,
`b_law_phase2Pent_non_QSP`,
`b_law_phase2FP_non_QSP`,  `b_law_phase2Other_non_QSP`,
`b_law_phase2Pent_QSP`, `b_law_phase2FP_QSP`,
`b_law_phase2Other_QSP`,  `b_has_prefix1:law_phase2FP`,
`b_has_prefix1:law_phase2LBH`,  `b_has_prefix1:law_phase2Other`,
`b_has_prefix1:law_phase2Pent_non_QSP`, `b_has_prefix1:law_phase2FP_non_QSP`,
`b_has_prefix1:law_phase2Other_non_QSP`,  `b_has_prefix1:law_phase2Pent_QSP`,
`b_has_prefix1:law_phase2FP_QSP`, `b_has_prefix1:law_phase2Other_QSP`
)
head(fixed_draws)
summary_prefix_dss <- fixed_draws %>%
transmute('Intercept Pentateuch non-QSP' = b_Intercept + b_law_phase2Pent_non_QSP,
'With Prefix Pentateuch non-QSP' = b_Intercept + b_law_phase2Pent_non_QSP + b_has_prefix1 + `b_has_prefix1:law_phase2Pent_non_QSP`,
'Intercept Former Prophets non_QSP' = b_Intercept + b_law_phase2FP_non_QSP,
'With Prefix Former Prophets non-QSP' = b_Intercept + b_law_phase2FP_non_QSP + b_has_prefix1 + `b_has_prefix1:law_phase2FP_non_QSP`,
'Intercept Other non-QSP' = b_Intercept + b_law_phase2Other_non_QSP,
'With Prefix Other non-QSP' = b_Intercept + b_law_phase2Other_non_QSP + b_has_prefix1 + `b_has_prefix1:law_phase2Other_non_QSP`,
'Intercept Pentateuch QSP' = b_Intercept + b_law_phase2Pent_QSP,
'With Prefix Pentateuch QSP' = b_Intercept + b_law_phase2Pent_QSP + b_has_prefix1 + `b_has_prefix1:law_phase2Pent_QSP`,
'Intercept Former Prophets QSP' = b_Intercept + b_law_phase2FP_QSP,
'With Prefix Former Prophets QSP' = b_Intercept + b_law_phase2FP_QSP + b_has_prefix1 + `b_has_prefix1:law_phase2FP_QSP`,
'Intercept Other QSP' = b_Intercept + b_law_phase2Other_QSP,
'With Prefix Other QSP' = b_Intercept + b_law_phase2Other_QSP + b_has_prefix1 + `b_has_prefix1:law_phase2Other_QSP`,
) %>%
gather() %>%
group_by(key) %>%
mean_hdi(.width = c(.95, .66))
summary_prefix_dss
labels_prefix_dss <- c(
'With Prefix Other QSP',
'Intercept Other QSP',
'With Prefix Former Prophets QSP',
'Intercept Former Prophets QSP',
'With Prefix Pentateuch QSP',
'Intercept Pentateuch QSP',
'With Prefix Other non-QSP',
'Intercept Other non-QSP',
'With Prefix Former Prophets non-QSP',
'Intercept Former Prophets non_QSP',
'With Prefix Pentateuch non-QSP',
'Intercept Pentateuch non-QSP'
)
summary_prefix_dss$key <- factor(summary_prefix_dss$key, levels = labels_prefix_dss)
summary_prefix_dss$prob_value <- logit2prob(summary_prefix_dss$value)
summary_prefix_dss$prob_lower <- logit2prob(summary_prefix_dss$.lower)
summary_prefix_dss$prob_upper <- logit2prob(summary_prefix_dss$.upper)
summary_prefix_dss[0:20,]
summary_prefix_dss %>%
ggplot(aes(y = key, x = prob_value, xmin = prob_lower, xmax = prob_upper)) +
geom_pointinterval() +
ggtitle('')
summary_prefix_mt <- fixed_draws %>%
transmute('Intercept Pentateuch' = b_Intercept,
'With Prefix Pentateuch' = b_Intercept + b_has_prefix1,
'Intercept Former Prophets' = b_Intercept + b_law_phase2FP,
'With Prefix Former Prophets' = b_Intercept + b_law_phase2FP + b_has_prefix1 + `b_has_prefix1:law_phase2FP`,
'Intercept LBH' = b_Intercept + b_law_phase2LBH,
'With Prefix LBH' = b_Intercept + b_law_phase2LBH + b_has_prefix1 + `b_has_prefix1:law_phase2LBH`,
'Intercept Other' = b_Intercept + b_law_phase2Other,
'With Prefix Other' = b_Intercept + b_law_phase2Other + b_has_prefix1 + `b_has_prefix1:law_phase2Other`,
) %>%
gather() %>%
group_by(key) %>%
mean_hdi(.width = c(.95, .66))
labels_prefix <- c(
'With Prefix Other',
'Intercept Other',
'With Prefix LBH',
'Intercept LBH',
'With Prefix Former Prophets',
'Intercept Former Prophets',
'With Prefix Pentateuch',
'Intercept Pentateuch'
)
summary_prefix_mt$key <- factor(summary_prefix_mt$key, levels = labels_prefix)
summary_prefix_mt$prob_value <- logit2prob(summary_prefix_mt$value)
summary_prefix_mt$prob_lower <- logit2prob(summary_prefix_mt$.lower)
summary_prefix_mt$prob_upper <- logit2prob(summary_prefix_mt$.upper)
summary_prefix_mt[0:20,]
summary_prefix_mt %>%
ggplot(aes(y = key, x = prob_value, xmin = prob_lower, xmax = prob_upper)) +
geom_pointinterval() +
ggtitle('')
summary_prefix_dss %>%
ggplot(aes(y = key, x = prob_value, xmin = prob_lower, xmax = prob_upper)) +
geom_pointinterval() +
xlab('Probability') +
ggtitle('')
summary_prefix_dss %>%
ggplot(aes(y = key, x = prob_value, xmin = prob_lower, xmax = prob_upper)) +
geom_pointinterval() +
xlab('Probability') +
ylab('') +
ggtitle('')
summary_prefix_mt %>%
ggplot(aes(y = key, x = prob_value, xmin = prob_lower, xmax = prob_upper)) +
geom_pointinterval() +
xlab('Probability') +
ylab('') +
ggtitle('')
