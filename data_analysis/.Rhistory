'Intercept Pentateuch QSP'
)
summary_prefix_dss$key <- factor(summary_prefix_dss$key, levels = labels_prefix_dss)
summary_prefix_dss %>%
ggplot(aes(y = key, x = value, xmin = .lower, xmax = .upper)) +
geom_pointinterval() +
xlab('Probability') +
ylab('') +
ggtitle('')
summary_prefix_dss <- fixed_draws %>%
transmute('Intercept Pentateuch non-QSP' = b_Intercept + b_law_phase2Pent_non_QSP,
'Intercept Former Prophets non_QSP' = b_Intercept + b_law_phase2FP_non_QSP,
'Intercept Other non-QSP' = b_Intercept + b_law_phase2Other_non_QSP,
) %>%
gather() %>%
group_by(key) %>%
mean_hdi(.width = c(.95, .66))
summary_prefix_dss
labels_prefix_dss <- c(
'Intercept Other non-QSP',
'Intercept Former Prophets non_QSP',
'Intercept Pentateuch non-QSP'
)
summary_prefix_dss$key <- factor(summary_prefix_dss$key, levels = labels_prefix_dss)
summary_prefix_dss %>%
ggplot(aes(y = key, x = value, xmin = .lower, xmax = .upper)) +
geom_pointinterval() +
scale_x_continuous(limits = c(-5, 5)) +
xlab('Probability') +
ylab('') +
ggtitle('')
summary_prefix_mt <- fixed_draws %>%
transmute('MT Pentateuch' = b_Intercept,
'MT Former Prophets' = b_Intercept + b_law_phase2FP,
'MT LBH' = b_Intercept + b_law_phase2LBH,
'MT Other' = b_Intercept + b_law_phase2Other,
'Ayin ayin verbs' = b_Intercept + b_ay_ay1 + b_i_yod1,
'I-yod verbs' = b_Intercept + b_i_yod1,
) %>%
gather() %>%
group_by(key) %>%
mean_hdi(.width = c(.95, .66))
labels_prefix <- c(
'I-yod verbs',
'Ayin ayin verbs',
'MT Other',
'MT LBH',
'MT Former Prophets',
'MT Pentateuch'
)
summary_prefix_mt$key <- factor(summary_prefix_mt$key, levels = labels_prefix)
summary_prefix_mt
summary_prefix_mt %>%
ggplot(aes(y = key, x = value, xmin = .lower, xmax = .upper)) +
geom_pointinterval() +
scale_x_continuous(limits = c(-5, 5)) +
xlab('Probability') +
ylab('') +
ggtitle('')
summary_prefix_mt <- fixed_draws %>%
transmute('MT Pentateuch' = b_Intercept,
'MT Former Prophets' = b_Intercept + b_law_phase2FP,
'MT LBH' = b_Intercept + b_law_phase2LBH,
'MT Other' = b_Intercept + b_law_phase2Other,
'Ayin ayin verbs' = b_Intercept + b_ay_ay1 + b_i_yod1,
'I-yod verbs' = b_Intercept + b_i_yod1,
) %>%
gather() %>%
group_by(key) %>%
mean_hdi(.width = c(.95, .66))
labels_prefix <- c(
'I-yod verbs',
'Ayin ayin verbs',
'MT Other',
'MT LBH',
'MT Former Prophets',
'MT Pentateuch'
)
summary_prefix_mt$key <- factor(summary_prefix_mt$key, levels = labels_prefix)
summary_prefix_mt
summary_prefix_mt %>%
ggplot(aes(y = key, x = value, xmin = .lower, xmax = .upper)) +
geom_pointinterval() +
scale_x_continuous(limits = c(-5, 5)) +
xlab('Probability') +
ylab('') +
ggtitle('')
# MAKE TABLE OF SUMMARY WITH PROBAB OF DIRECTION
library(htmlTable)
library(kableExtra)
library(magick)
IMAGE_FOLDER <- 'C:/Users/geitb/Dropbox/monograph_orthography/verbs/images_ptcp'
fixed <- summary(bayes_model_mt_dss_infa4)$fixed
fixed$Rhat <- sprintf('%.2f', fixed$Rhat)
round_names <- c('Estimate', 'Est.Error', 'l-95% CI', 'u-95% CI')
for (name in round_names) {
fixed[,name] <- fixed[,name] |> round(2)
}
fixed$Bulk_ESS <- round(fixed$Bulk_ESS, 0)
fixed$Tail_ESS <- round(fixed$Tail_ESS, 0)
p_dir <- trace_mt |> p_direction()
fixed$pd <- round(p_dir$pd,2)
fixed |> htmlTable() |>
save_kable(file = file.path(IMAGE_FOLDER, 'ptcp_table.png'))
p_dir <- bayes_model_mt_dss_infa4 |> p_direction()
fixed$pd <- round(p_dir$pd,2)
fixed |> htmlTable() |>
save_kable(file = file.path(IMAGE_FOLDER, 'ptcp_table.png'))
fixed |> htmlTable() |>
save_kable(file = file.path(IMAGE_FOLDER, 'infa_table.png'))
# MAKE TABLE OF SUMMARY WITH PROBAB OF DIRECTION
library(htmlTable)
library(kableExtra)
library(magick)
IMAGE_FOLDER <- 'C:/Users/geitb/Dropbox/monograph_orthography/verbs/images_infa'
# MAKE TABLE OF SUMMARY WITH PROBAB OF DIRECTION
library(htmlTable)
library(kableExtra)
library(magick)
IMAGE_FOLDER <- 'C:/Users/geitb/Dropbox/monograph_orthography/verbs/images_infa'
fixed <- summary(bayes_model_mt_dss_infa4)$fixed
fixed$Rhat <- sprintf('%.2f', fixed$Rhat)
round_names <- c('Estimate', 'Est.Error', 'l-95% CI', 'u-95% CI')
for (name in round_names) {
fixed[,name] <- fixed[,name] |> round(2)
}
fixed$Bulk_ESS <- round(fixed$Bulk_ESS, 0)
fixed$Tail_ESS <- round(fixed$Tail_ESS, 0)
p_dir <- bayes_model_mt_dss_infa4 |> p_direction()
fixed$pd <- round(p_dir$pd,2)
fixed |> htmlTable() |>
save_kable(file = file.path(IMAGE_FOLDER, 'infa_table.png'))
library(tidyverse)
library(brms)
library(bayesplot)
library(tidybayes)
library(ggeffects)
library(bayestestR)
MODEL_FOLDER <- 'C:/Users/geitb/Kopenhagen/KopenhagenResearch/monograph/chapters/NounsAdjectives/models_rstanarm'
EBH_BOOKS <- c("Genesis", "Exodus", "Leviticus", "Numbers", "Deuteronomy", "Joshua",
"Judges", "1_Samuel", "2_Samuel", "1_Kings", "2_Kings")
LBH_BOOKS <- c("Esther", "Daniel", "Ezra", "Nehemiah", "1_Chronicles", "2_Chronicles")
LAW_BOOKS <- c("Genesis", "Exodus", "Leviticus", "Numbers", "Deuteronomy")
QSP_SCROLLS = c('1Qisaa', '1QisaaI', '1QisaaII', '2Q3', '4Q13', '4Q20', '2Q7', '4Q27', '1Q4', '2Q12', '4Q37', '4Q38', '4Q38a', '4Q40', '4Q53',
'4Q57', '2Q13', '4Q78', '4Q80', '4Q82', '4Q128', '4Q129', '4Q134', '4Q135', '4Q136',
'4Q137', '4Q138', '4Q139', '4Q140', '4Q141', '4Q142', '4Q143', '4Q144', '4Q158', '4Q364',
'4Q365', '4Q96', '4Q111', '4Q109', '11Q5', '11Q6', '11Q7', '11Q8')
length(QSP_SCROLLS)
# VERBS WITH ARTICIPLES WITHOUT O SOUND IN MT
NOT_USEFUL_VERBS <- c('ML>[', 'JR>[', '>SP[')
logit2prob <- function(logit){
odds <- exp(logit)
prob <- odds / (1 + odds)
return(prob)
}
dat <- read.csv('C:/Users/geitb/Kopenhagen/KopenhagenResearch/scripts_research/hebrew_spelling_variation/data/ptca_qal.csv', sep='\t')
dim(dat)
head(dat)
str(dat)
unique(dat$book)
dat <- dat[!(dat$pattern == '' & dat$scroll == 'MT'),]
sum(is.na(dat$pattern))
sum(table(dat$pattern))
dat$has_suffix <- as.factor(as.numeric(dat$has_prs | dat$has_nme | dat$has_hloc))
# has_prefix, has_prs, has_nme, lex, book, has_vowel_letter
dat$has_prefix <- as.factor(dat$has_prefix)
dat$has_prs <- as.factor(dat$has_prs)
dat$has_nme <- as.factor(dat$has_nme)
dat$has_hloc <- as.factor(dat$has_hloc)
dat$lex <- as.factor(dat$lex)
dat$book <- as.factor(dat$book)
dat$has_vowel_letter <- as.factor(dat$has_vowel_letter)
dat$type <- as.factor(dat$type)
dat$book2 <- dat$book %>% str_replace('1_', '') |> str_replace('2_', '')
table(dat$book2)
# Make 2 scrolls of 1Qisaa
dat$scroll <- ifelse(dat$scroll == '1Qisaa' & dat$chapter < 34, '1QisaaI',
ifelse(dat$scroll == '1Qisaa' & dat$chapter > 33, '1QisaaII',
dat$scroll))
dat$scroll <- as.factor(dat$scroll)
dat$scr_book2 <- paste(dat$scroll, dat$book2, sep='_')
mt_sp_books <- unique(dat$scr_book2)
mt_sp_books
dat$scr_book2 <- factor(dat$scr_book2, levels = mt_sp_books)
unique(dat$scr_book2)
dat$book2 <- as.factor(dat$book2)
dat$phase <- ifelse(dat$book %in% EBH_BOOKS, 'EBH', ifelse(dat$book %in% LBH_BOOKS, 'LBH', 'NO'))
dat$law_phase <- ifelse(dat$book %in% LAW_BOOKS, 0, ifelse(dat$book %in% EBH_BOOKS, 1,
ifelse(dat$book %in% LBH_BOOKS, 2, 3)))
dat$law_phase <- as.factor(dat$law_phase)
dat$qsp_sp <- ifelse(dat$scroll %in% QSP_SCROLLS, 'QSP', ifelse(dat$scroll == 'SP', 'SP', 'Other'))
dat$qsp_sp <- as.factor(dat$qsp_sp)
table(dat$qsp_sp)
str(dat)
dat$type
dat$type <- factor(dat$type, levels = c('last', 'first', 'single'))
levels(dat$type)
# Merge single and last syllables in new variable type2
dat$type2 <- ifelse(dat$type %in% c('single', 'last'), 'last', 'first')
dat$type2 <- factor(dat$type2, levels = c('last', 'first'))
dat$lex_type <- paste(dat$lex, dat$type2, sep='_')
dat$lex_type <- as.factor(dat$lex_type)
dat$law_phase2 <- ifelse(dat$book %in% LAW_BOOKS, 'Pent',
ifelse(dat$book %in% EBH_BOOKS, 'FP',
ifelse(dat$book %in% LBH_BOOKS, 'LBH',
'Other')))
dat$law_phase2 <- ifelse(!dat$scroll %in% c(c('MT', 'SP'), QSP_SCROLLS), paste0(dat$law_phase2, '_non_QSP'),
ifelse(dat$scroll %in% QSP_SCROLLS, paste0(dat$law_phase2, '_QSP'),
ifelse(dat$scroll == 'SP', paste0(dat$law_phase2, '_SP'),
dat$law_phase2)))
dat$law_phase2 <- as.factor(dat$law_phase2)
law_phase2_levels <- c('Pent', 'Pent_SP', 'FP', 'LBH', 'Other',
'Pent_non_QSP', 'FP_non_QSP', 'LBH_non_QSP',
'Other_non_QSP',
'Pent_QSP', 'Other_QSP')
dat$law_phase2 <- factor(dat$law_phase2, levels=law_phase2_levels)
levels(dat$law_phase2)
dim(dat)
head(dat)
mt_sp <- dat |> filter(scroll %in% c('SP', 'MT'))
str(mt_sp)
mt_sp <- droplevels(mt_sp)
table(mt_sp$type2)
table(dat$law_phase2)
dat$ay_ay <- as.factor(as.numeric(substr(dat$lex, 2, 2) == substr(dat$lex, 3, 3)))
dat$i_yod <- as.factor(as.numeric(substr(dat$lex, 1, 1) == 'J'))
dat$iii_h <- as.factor(as.numeric(substr(dat$lex, 3, 3) == 'H'))
dat$iii_alef <- as.factor(as.numeric(substr(dat$lex, 3, 3) == '>'))
dat$i_nun <- as.factor(as.numeric(substr(dat$lex, 1, 1) == 'N'))
head(dat)
str(dat)
dat <- dat |> filter(!lex %in% NOT_USEFUL_VERBS) |> droplevels()
'ML>[' %in% dat$lex
# III-he
table(dat$iii_h, dat$has_vowel_letter, dat$law_phase2)
# I-yod
table(dat$i_yod, dat$has_vowel_letter, dat$law_phase2)
ay_ay_df <- dat |> group_by(law_phase2, iii_h) |> summarise(full_count = sum(as.numeric(as.character(has_vowel_letter))),
total_count = n())
hpd_ay_ay <- binom.bayes(
x = ay_ay_df$full_count, n = ay_ay_df$total_count, type = "highest", conf.level = 0.95, tol = 1e-9)
# DATA EXPLORATION
#install.packages('binom')
library(binom)
table(dat$ay_ay, dat$has_vowel_letter)
# Ay-Ay
ay_ay_df <- dat |> group_by(law_phase2, ay_ay) |> summarise(full_count = sum(as.numeric(as.character(has_vowel_letter))),
total_count = n())
hpd_ay_ay <- binom.bayes(
x = ay_ay_df$full_count, n = ay_ay_df$total_count, type = "highest", conf.level = 0.95, tol = 1e-9)
hpd_ay_ay$law_phase2 <- ay_ay_df$law_phase2
hpd_ay_ay$ay_ay <- ay_ay_df$ay_ay
groups <- c('Pent', 'Pent_SP', 'FP', 'LBH', 'Other', 'Pent_non_QSP',
'FP_non_QSP','LBH_non_QSP' ,'Other_non_QSP', 'Pent_QSP', 'Other_QSP')
hpd_ay_ay$law_phase2 <- factor(hpd_ay_ay$law_phase2, levels=groups)
ggplot(data = hpd_ay_ay, aes(x = law_phase2, y = mean, fill = as.factor(ay_ay))) +
geom_bar(stat = "identity", color = "black", position = position_dodge()) +
labs(x = '', y = 'Fraction of full spelling', fill = "Ayin Ayin") +
geom_errorbar( aes(x=law_phase2, ymin=lower, ymax=upper), width=0.4, colour='black', alpha=0.9, size=1.3,
position = position_dodge(0.9)) +
theme_minimal() +
theme(text = element_text(size = 20)) +
theme(axis.text.x = element_text(angle = 45, hjust=1))
# DATA EXPLORATION
#install.packages('binom')
library(binom)
table(dat$ay_ay, dat$has_vowel_letter)
# Ay-Ay
ay_ay_df <- dat |> group_by(law_phase2, ay_ay) |> summarise(full_count = sum(as.numeric(as.character(has_vowel_letter))),
total_count = n())
hpd_ay_ay <- binom.bayes(
x = ay_ay_df$full_count, n = ay_ay_df$total_count, type = "highest", conf.level = 0.95, tol = 1e-9)
hpd_ay_ay$law_phase2 <- ay_ay_df$law_phase2
hpd_ay_ay$ay_ay <- ay_ay_df$ay_ay
groups <- c('MT Pentateuch', 'SP', 'MT Former Prophets', 'MT LBH', 'MT Other',
'Non-QSP Pentateuch', 'Non-QSP Former Prophets', 'Non-QSP LBH', 'Non-QSP Other',
'QSP Pentateuch', 'QSP Other')
#groups <- c('Pent', 'Pent_SP', 'FP', 'LBH', 'Other', 'Pent_non_QSP',
#            'FP_non_QSP','LBH_non_QSP' ,'Other_non_QSP', 'Pent_QSP', 'Other_QSP')
hpd_ay_ay$law_phase2 <- factor(hpd_ay_ay$law_phase2, levels=groups)
ggplot(data = hpd_ay_ay, aes(x = law_phase2, y = mean, fill = as.factor(ay_ay))) +
geom_bar(stat = "identity", color = "black", position = position_dodge()) +
labs(x = '', y = 'Fraction of full spelling', fill = "Ayin Ayin") +
geom_errorbar( aes(x=law_phase2, ymin=lower, ymax=upper), width=0.4, colour='black', alpha=0.9, size=1.3,
position = position_dodge(0.9)) +
theme_minimal() +
theme(text = element_text(size = 20)) +
theme(axis.text.x = element_text(angle = 45, hjust=1))
groups <- c('Pent', 'Pent_SP', 'FP', 'LBH', 'Other', 'Pent_non_QSP',
'FP_non_QSP','LBH_non_QSP' ,'Other_non_QSP', 'Pent_QSP', 'Other_QSP')
hpd_ay_ay$law_phase2 <- factor(hpd_ay_ay$law_phase2, levels=groups)
ggplot(data = hpd_ay_ay, aes(x = law_phase2, y = mean, fill = as.factor(ay_ay))) +
geom_bar(stat = "identity", color = "black", position = position_dodge()) +
labs(x = '', y = 'Fraction of full spelling', fill = "Ayin Ayin") +
geom_errorbar( aes(x=law_phase2, ymin=lower, ymax=upper), width=0.4, colour='black', alpha=0.9, size=1.3,
position = position_dodge(0.9)) +
theme_minimal() +
theme(text = element_text(size = 20)) +
theme(axis.text.x = element_text(angle = 45, hjust=1))
hpd_ay_ay
groups <- c('MT Pentateuch', 'SP', 'MT Former Prophets', 'MT LBH', 'MT Other',
'Non-QSP Pentateuch', 'Non-QSP Former Prophets', 'Non-QSP LBH', 'Non-QSP Other',
'QSP Pentateuch', 'QSP Other')
groups <- c('Pent', 'Pent_SP', 'FP', 'LBH', 'Other', 'Pent_non_QSP',
'FP_non_QSP','LBH_non_QSP' ,'Other_non_QSP', 'Pent_QSP', 'Other_QSP')
hpd_ay_ay$law_phase2 <- factor(hpd_ay_ay$law_phase2, levels=groups)
hpd_ay_ay
# Ay-Ay
ay_ay_df <- dat |> group_by(law_phase2, ay_ay) |> summarise(full_count = sum(as.numeric(as.character(has_vowel_letter))),
total_count = n())
hpd_ay_ay <- binom.bayes(
x = ay_ay_df$full_count, n = ay_ay_df$total_count, type = "highest", conf.level = 0.95, tol = 1e-9)
hpd_ay_ay$law_phase2 <- ay_ay_df$law_phase2
hpd_ay_ay$ay_ay <- ay_ay_df$ay_ay
hpd_ay_ay
groups <- c('MT Pentateuch', 'SP', 'MT Former Prophets', 'MT LBH', 'MT Other',
'Non-QSP Pentateuch', 'Non-QSP Former Prophets', 'Non-QSP LBH', 'Non-QSP Other',
'QSP Pentateuch', 'QSP Other')
hpd_ay_ay
hpd_ay_ay$law_phase2 <- factor(hpd_ay_ay$law_phase2, levels=groups)
hpd_ay_ay
# Ay-Ay
ay_ay_df <- dat |> group_by(law_phase2, ay_ay) |> summarise(full_count = sum(as.numeric(as.character(has_vowel_letter))),
total_count = n())
hpd_ay_ay <- binom.bayes(
x = ay_ay_df$full_count, n = ay_ay_df$total_count, type = "highest", conf.level = 0.95, tol = 1e-9)
hpd_ay_ay$law_phase2 <- ay_ay_df$law_phase2
hpd_ay_ay$ay_ay <- ay_ay_df$ay_ay
hpd_ay_ay
groups <- c('MT Pentateuch', 'SP', 'MT Former Prophets', 'MT LBH', 'MT Other',
'Non-QSP Pentateuch', 'Non-QSP Former Prophets', 'Non-QSP LBH', 'Non-QSP Other',
'QSP Pentateuch', 'QSP Other')
hpd_ay_ay$law_phase2 <- factor(hpd_ay_ay$law_phase2, levels=groups)
hpd_ay_ay
# Ay-Ay
ay_ay_df <- dat |> group_by(law_phase2, ay_ay) |> summarise(full_count = sum(as.numeric(as.character(has_vowel_letter))),
total_count = n())
hpd_ay_ay <- binom.bayes(
x = ay_ay_df$full_count, n = ay_ay_df$total_count, type = "highest", conf.level = 0.95, tol = 1e-9)
hpd_ay_ay$law_phase2 <- ay_ay_df$law_phase2
hpd_ay_ay$ay_ay <- ay_ay_df$ay_ay
hpd_ay_ay
# Ay-Ay
ay_ay_df <- dat |> group_by(law_phase2, ay_ay) |> summarise(full_count = sum(as.numeric(as.character(has_vowel_letter))),
total_count = n())
hpd_ay_ay <- binom.bayes(
x = ay_ay_df$full_count, n = ay_ay_df$total_count, type = "highest", conf.level = 0.95, tol = 1e-9)
hpd_ay_ay
table(dat$ay_ay, dat$has_vowel_letter)
# Ay-Ay
ay_ay_df <- dat |> group_by(law_phase2, ay_ay) |> summarise(full_count = sum(as.numeric(as.character(has_vowel_letter))),
total_count = n())
hpd_ay_ay <- binom.bayes(
x = ay_ay_df$full_count, n = ay_ay_df$total_count, type = "highest", conf.level = 0.95, tol = 1e-9)
hpd_ay_ay$law_phase2 <- ay_ay_df$law_phase2
hpd_ay_ay$ay_ay <- ay_ay_df$ay_ay
hpd_ay_ay
# Ay-Ay
ay_ay_df <- dat |> group_by(law_phase2, ay_ay) |> summarise(full_count = sum(as.numeric(as.character(has_vowel_letter))),
total_count = n())
hpd_ay_ay <- binom.bayes(
x = ay_ay_df$full_count, n = ay_ay_df$total_count, type = "highest", conf.level = 0.95, tol = 1e-9)
#hpd_ay_ay$law_phase2 <- ay_ay_df$law_phase2
hpd_ay_ay$ay_ay <- ay_ay_df$ay_ay
hpd_ay_ay$law_phase2  <- c('MT Pentateuch', 'MT Pentateuch', 'SP', 'SP', 'MT Former Prophets', 'MT Former Prophets',
'MT LBH', 'MT LBH', 'MT Other', 'MT Other',
'Non-QSP Pentateuch', 'Non-QSP Former Prophets', 'Non-QSP LBH', 'Non-QSP Other', 'Non-QSP Other',
'QSP Pentateuch', 'QSP Other', 'QSP Other')
groups <- c('MT Pentateuch', 'SP', 'MT Former Prophets', 'MT LBH', 'MT Other',
'Non-QSP Pentateuch', 'Non-QSP Former Prophets', 'Non-QSP LBH', 'Non-QSP Other',
'QSP Pentateuch', 'QSP Other')
hpd_ay_ay$law_phase2 <- factor(hpd_ay_ay$law_phase2, levels=unique(groups))
ggplot(data = hpd_ay_ay, aes(x = law_phase2, y = mean, fill = as.factor(ay_ay))) +
geom_bar(stat = "identity", color = "black", position = position_dodge()) +
labs(x = '', y = 'Fraction of full spelling', fill = "Ayin Ayin") +
geom_errorbar( aes(x=law_phase2, ymin=lower, ymax=upper), width=0.4, colour='black', alpha=0.9, size=1.3,
position = position_dodge(0.9)) +
theme_minimal() +
theme(text = element_text(size = 20)) +
theme(axis.text.x = element_text(angle = 45, hjust=1))
# I-yod
ay_ay_df <- dat |> group_by(law_phase2, i_yod) |> summarise(full_count = sum(as.numeric(as.character(has_vowel_letter))),
total_count = n())
hpd_ay_ay <- binom.bayes(
x = ay_ay_df$full_count, n = ay_ay_df$total_count, type = "highest", conf.level = 0.95, tol = 1e-9)
hpd_ay_ay$law_phase2 <- ay_ay_df$law_phase2
hpd_ay_ay$ay_ay <- ay_ay_df$i_yod
hpd_ay_ay
# I-yod
ay_ay_df <- dat |> group_by(law_phase2, i_yod) |> summarise(full_count = sum(as.numeric(as.character(has_vowel_letter))),
total_count = n())
hpd_ay_ay <- binom.bayes(
x = ay_ay_df$full_count, n = ay_ay_df$total_count, type = "highest", conf.level = 0.95, tol = 1e-9)
hpd_ay_ay$law_phase2 <- ay_ay_df$law_phase2
hpd_ay_ay$ay_ay <- ay_ay_df$i_yod
hpd_ay_ay
hpd_ay_ay$law_phase2  <- c('MT Pentateuch', 'MT Pentateuch', 'SP', 'SP', 'MT Former Prophets', 'MT Former Prophets',
'MT LBH', 'MT LBH', 'MT Other', 'MT Other',
'Non-QSP Pentateuch', 'Non-QSP Pentateuch', 'Non-QSP Former Prophets', 'Non-QSP Former Prophets',
'Non-QSP LBH', 'Non-QSP Other', 'Non-QSP Other',
'QSP Pentateuch', 'QSP Pentateuch', 'QSP Other', 'QSP Other')
#groups <- c('Pent', 'Pent_SP', 'FP', 'LBH', 'Other', 'Pent_non_QSP',
#            'FP_non_QSP','LBH_non_QSP' ,'Other_non_QSP', 'Pent_QSP', 'Other_QSP')
hpd_ay_ay$law_phase2 <- factor(hpd_ay_ay$law_phase2, levels=unique(groups))
ggplot(data = hpd_ay_ay, aes(x = law_phase2, y = mean, fill = as.factor(ay_ay))) +
geom_bar(stat = "identity", color = "black", position = position_dodge()) +
labs(x = '', y = 'Fraction of full spelling', fill = "I-yod") +
geom_errorbar( aes(x=law_phase2, ymin=lower, ymax=upper), width=0.4, colour='black', alpha=0.9, size=1.3,
position = position_dodge(0.9)) +
theme_minimal() +
theme(text = element_text(size = 20)) +
theme(axis.text.x = element_text(angle = 45, hjust=1))
ggplot(data = hpd_ay_ay, aes(x = law_phase2, y = mean, fill = as.factor(ay_ay))) +
geom_bar(stat = "identity", color = "black", position = position_dodge()) +
labs(x = '', y = 'Fraction of full spelling', fill = "Ayin Ayin") +
geom_errorbar( aes(x=law_phase2, ymin=lower, ymax=upper), width=0.4, colour='black', alpha=0.9, size=1.3,
position = position_dodge(0.9)) +
theme_minimal() +
theme(text = element_text(size = 20)) +
theme(axis.text.x = element_text(angle = 45, hjust=1)) +
scale_fill_discrete(name = "Dose", labels = c("A", "B"))
ggplot(data = hpd_ay_ay, aes(x = law_phase2, y = mean, fill = as.factor(ay_ay))) +
geom_bar(stat = "identity", color = "black", position = position_dodge()) +
labs(x = '', y = 'Fraction of full spelling', fill = "Ayin Ayin") +
geom_errorbar( aes(x=law_phase2, ymin=lower, ymax=upper), width=0.4, colour='black', alpha=0.9, size=1.3,
position = position_dodge(0.9)) +
theme_minimal() +
theme(text = element_text(size = 20)) +
theme(axis.text.x = element_text(angle = 45, hjust=1)) +
scale_fill_discrete(name = '', labels = c("Other verbs", "Ayin-ayin verbs"))
ggplot(data = hpd_ay_ay, aes(x = law_phase2, y = mean, fill = as.factor(ay_ay))) +
geom_bar(stat = "identity", color = "black", position = position_dodge()) +
labs(x = '', y = 'Fraction of full spelling', fill = "Ayin Ayin") +
geom_errorbar( aes(x=law_phase2, ymin=lower, ymax=upper), width=0.4, colour='black', alpha=0.9, size=1.3,
position = position_dodge(0.9)) +
theme_minimal() +
theme(text = element_text(size = 20)) +
theme(axis.text.x = element_text(angle = 45, hjust=1)) +
scale_fill_discrete(name = '', labels = c('Other verbs', 'Ayin-ayin verbs'))
# Ay-Ay
ay_ay_df <- dat |> group_by(law_phase2, ay_ay) |> summarise(full_count = sum(as.numeric(as.character(has_vowel_letter))),
total_count = n())
hpd_ay_ay <- binom.bayes(
x = ay_ay_df$full_count, n = ay_ay_df$total_count, type = "highest", conf.level = 0.95, tol = 1e-9)
#hpd_ay_ay$law_phase2 <- ay_ay_df$law_phase2
hpd_ay_ay$ay_ay <- ay_ay_df$ay_ay
hpd_ay_ay$law_phase2  <- c('MT Pentateuch', 'MT Pentateuch', 'SP', 'SP', 'MT Former Prophets', 'MT Former Prophets',
'MT LBH', 'MT LBH', 'MT Other', 'MT Other',
'Non-QSP Pentateuch', 'Non-QSP Former Prophets', 'Non-QSP LBH', 'Non-QSP Other', 'Non-QSP Other',
'QSP Pentateuch', 'QSP Other', 'QSP Other')
groups <- c('MT Pentateuch', 'SP', 'MT Former Prophets', 'MT LBH', 'MT Other',
'Non-QSP Pentateuch', 'Non-QSP Former Prophets', 'Non-QSP LBH', 'Non-QSP Other',
'QSP Pentateuch', 'QSP Other')
hpd_ay_ay$law_phase2 <- factor(hpd_ay_ay$law_phase2, levels=unique(groups))
ggplot(data = hpd_ay_ay, aes(x = law_phase2, y = mean, fill = as.factor(ay_ay))) +
geom_bar(stat = "identity", color = "black", position = position_dodge()) +
labs(x = '', y = 'Fraction of full spelling', fill = "Ayin Ayin") +
geom_errorbar( aes(x=law_phase2, ymin=lower, ymax=upper), width=0.4, colour='black', alpha=0.9, size=1.3,
position = position_dodge(0.9)) +
theme_minimal() +
theme(text = element_text(size = 20)) +
theme(axis.text.x = element_text(angle = 45, hjust=1)) +
scale_fill_discrete(name = '', labels = c('Other verbs', 'Ayin-ayin verbs'))
# Ay-Ay
ay_ay_df <- dat |> group_by(law_phase2, ay_ay) |> summarise(full_count = sum(as.numeric(as.character(has_vowel_letter))),
total_count = n())
hpd_ay_ay <- binom.bayes(
x = ay_ay_df$full_count, n = ay_ay_df$total_count, type = "highest", conf.level = 0.95, tol = 1e-9)
#hpd_ay_ay$law_phase2 <- ay_ay_df$law_phase2
hpd_ay_ay$ay_ay <- ay_ay_df$ay_ay
hpd_ay_ay$law_phase2  <- c('MT Pentateuch', 'MT Pentateuch', 'SP', 'SP', 'MT Former Prophets', 'MT Former Prophets',
'MT LBH', 'MT LBH', 'MT Other', 'MT Other',
'Non-QSP Pentateuch', 'Non-QSP Former Prophets', 'Non-QSP LBH', 'Non-QSP Other', 'Non-QSP Other',
'QSP Pentateuch', 'QSP Other', 'QSP Other')
groups <- c('MT Pentateuch', 'SP', 'MT Former Prophets', 'MT LBH', 'MT Other',
'Non-QSP Pentateuch', 'Non-QSP Former Prophets', 'Non-QSP LBH', 'Non-QSP Other',
'QSP Pentateuch', 'QSP Other')
hpd_ay_ay$law_phase2 <- factor(hpd_ay_ay$law_phase2, levels=unique(groups))
ggplot(data = hpd_ay_ay, aes(x = law_phase2, y = mean, fill = as.factor(ay_ay))) +
geom_bar(stat = "identity", color = "black", position = position_dodge()) +
labs(x = '', y = 'Fraction of full spelling', fill = "Ayin Ayin") +
geom_errorbar( aes(x=law_phase2, ymin=lower, ymax=upper), width=0.4, colour='black', alpha=0.9, size=1.3,
position = position_dodge(0.9)) +
theme_minimal() +
theme(text = element_text(size = 20)) +
theme(axis.text.x = element_text(angle = 45, hjust=1)) +
scale_fill_discrete(name = '', labels = c('Other verbs', 'Ayin-ayin verbs'))
# I-yod
ay_ay_df <- dat |> group_by(law_phase2, i_yod) |> summarise(full_count = sum(as.numeric(as.character(has_vowel_letter))),
total_count = n())
hpd_ay_ay <- binom.bayes(
x = ay_ay_df$full_count, n = ay_ay_df$total_count, type = "highest", conf.level = 0.95, tol = 1e-9)
hpd_ay_ay$law_phase2 <- ay_ay_df$law_phase2
hpd_ay_ay$ay_ay <- ay_ay_df$i_yod
hpd_ay_ay
hpd_ay_ay$law_phase2  <- c('MT Pentateuch', 'MT Pentateuch', 'SP', 'SP', 'MT Former Prophets', 'MT Former Prophets',
'MT LBH', 'MT LBH', 'MT Other', 'MT Other',
'Non-QSP Pentateuch', 'Non-QSP Pentateuch', 'Non-QSP Former Prophets', 'Non-QSP Former Prophets',
'Non-QSP LBH', 'Non-QSP Other', 'Non-QSP Other',
'QSP Pentateuch', 'QSP Pentateuch', 'QSP Other', 'QSP Other')
#groups <- c('Pent', 'Pent_SP', 'FP', 'LBH', 'Other', 'Pent_non_QSP',
#            'FP_non_QSP','LBH_non_QSP' ,'Other_non_QSP', 'Pent_QSP', 'Other_QSP')
hpd_ay_ay$law_phase2 <- factor(hpd_ay_ay$law_phase2, levels=unique(groups))
ggplot(data = hpd_ay_ay, aes(x = law_phase2, y = mean, fill = as.factor(ay_ay))) +
geom_bar(stat = "identity", color = "black", position = position_dodge()) +
labs(x = '', y = 'Fraction of full spelling', fill = "I-yod") +
geom_errorbar( aes(x=law_phase2, ymin=lower, ymax=upper), width=0.4, colour='black', alpha=0.9, size=1.3,
position = position_dodge(0.9)) +
theme_minimal() +
theme(text = element_text(size = 20)) +
theme(axis.text.x = element_text(angle = 45, hjust=1)) +
scale_fill_discrete(name = '', labels = c('Other verbs', 'I-yod verbs'))
